server {
  listen 80;
  server_name _;

  # App A
  location ^~ /a {
    root /var/www/empty;    # nincs szükség statikus fájlokra
    rewrite ^/a/?(.*)$ /$1 break;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME /index.php;
    fastcgi_pass php_a:9000;
  }

  # App B
  location ^~ /b {
    root /var/www/empty;
    rewrite ^/b/?(.*)$ /$1 break;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME /index.php;
    fastcgi_pass php_b:9000;
  }

  client_max_body_size 10m;
  add_header X-Frame-Options "SAMEORIGIN" always;
  add_header X-Content-Type-Options "nosniff" always;
  add_header Referrer-Policy "strict-origin-when-cross-origin" always;
}

# Belső-only healthcheck (csak konténerből)
server {
  listen 127.0.0.1:8081;
  server_name _;
  location = /health { return 200 "ok\n"; add_header Content-Type text/plain; }
}
